import{g as v,b as y,u as w,h as x}from"./entry.190e60b0.js";import{_ as $}from"./client-only.5e6823b7.js";import{b as T,o as B,_ as L,$ as p,Z as S,a8 as t,H as f,ac as _,v as c,A as o,a0 as E}from"./swiper-vue.08c57f7b.js";import{u as R}from"./authStore.3aea4787.js";import{d as h,U}from"./requestURL.059e2fdd.js";const G={class:"full_height mt185ptb30"},N={class:"container"},V=t("h3",{class:"login_tl"},[o(" \u6703\u54E1\u767B\u5165"),t("br"),o("Login ")],-1),q=t("div",{class:"social_login"},[o(" \u4F7F\u7528\uFF1A "),t("a",{href:"",class:"btn btn-check bg-facebook"},[t("i",{class:"fa-brands fa-facebook-f"}),o(" facebook\u5E33\u865F\u767B\u5165 ")]),t("a",{href:"",class:"btn btn-check bg-google"},[t("i",{class:"fa-brands fa-google-plus-g"}),o(" Google\u5E33\u865F\u767B\u5165 ")]),t("a",{href:"",class:"btn btn-check bg-line"},[t("i",{class:"fa-brands fa-line"}),o(" Line\u5E33\u865F\u767B\u5165 ")])],-1),A={class:"contact-form"},C={id:"",method:"post",action:"javascript:;"},P={class:"form-group"},I={class:"form-group"},O=t("div",{class:"text-center mt-30"},[t("i",{class:"fa-regular fa-circle-question"}),t("a",{href:"forgotten.html"},"\u5FD8\u8A18\u5BC6\u78BC?")],-1),z={class:"other_function"},J={__name:"login",setup(F){const m=v(),d=y(),a=R(),i=w(),n=T({email:"",password:""});B(async()=>{const e=localStorage.getItem("accessToken");if(e){try{const s=await $fetch(`${i.public.apiBase}/${h}`,{method:"GET",headers:{Authorization:"Bearer "+e}});a.loginSuccess(e),a.updateUser(s.data)}catch{a.logout()}u()}});async function b(){try{const e=await $fetch(`${i.public.apiBase}/${U}`,{method:"POST",body:n.value});console.log(e),g(e.data)}catch(e){e.statusCode&&alert("\u8ACB\u8F38\u5165\u6B63\u78BA\u7684\u5E33\u865F\u53CA\u5BC6\u78BC")}}async function g(e){const{accessToken:s}=e;a.loginSuccess(s);const r=await $fetch(`${i.public.apiBase}/${h}`,{method:"GET",headers:{Authorization:"Bearer "+s}});a.updateUser(r.data),u()}function u(){var s;const e=(s=m.query)==null?void 0:s.redirect;e?d.push({path:e}):d.push({path:"/profile"})}return(e,s)=>{const r=x,k=$;return S(),L(k,null,{default:p(()=>[t("section",G,[t("div",N,[V,q,t("div",A,[t("form",C,[t("div",P,[f(t("input",{id:"input-field-email","onUpdate:modelValue":s[0]||(s[0]=l=>c(n).email=l),type:"email",placeholder:"Email*",class:"form-control",name:"",required:""},null,512),[[_,c(n).email]])]),t("div",I,[f(t("input",{id:"input-field-password","onUpdate:modelValue":s[1]||(s[1]=l=>c(n).password=l),autocomplete:"",type:"password",placeholder:"\u5BC6\u78BC*",class:"form-control",name:"",required:""},null,512),[[_,c(n).password]])]),t("div",{class:"text-center"},[t("input",{id:"input-field-submit",type:"submit",class:"btn btn-main btn-bag",value:"\u6211\u8981\u767B\u5165",onClick:b})])]),O,t("div",z,[o(" \u6C92\u6709\u5E33\u865F? "),E(r,{class:"btn btn-block btn-bag",to:"/register"},{default:p(()=>[o(" \u6703\u54E1\u8A3B\u518A ")]),_:1})])])])])]),_:1})}}};export{J as default};
