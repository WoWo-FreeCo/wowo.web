import{a as m,u as aa,m as sa,g as ea,h as oa,e as ta,x as ca,y as O,k as na}from"./entry.0cbc246d.js";import{b as _,o as la,q as ra,_ as v,aa as s,y as c,ae as p,F as R,V as D,ac as i,J as F,G as N,Z as g,$ as S,a0 as x,C as y,a8 as da,a9 as ua}from"./swiper-vue.2e988726.js";const h=k=>(da("data-v-3348c721"),k=k(),ua(),k),ia={class:"full_height mt-120"},_a={class:"row"},pa={class:"col-sm-3 p-0 bg_left2"},ha={id:"accordion",class:"panel-group commonAccordion",role:"tablist","aria-multiselectable":"true"},fa={class:"panel panel-default"},va={id:"headingOne",class:"panel-heading",role:"tab"},ga={class:"panel-title"},ya={class:"col-sm-9 pl20pr30"},$a={class:"breadcrumb"},Ia=h(()=>s("li",null,[s("a",{href:"/"},"Home")],-1)),ba=h(()=>s("li",null,"\u7522\u54C1\u4ECB\u7D39",-1)),ka={class:"active"},Ca={class:"row"},Pa={class:"flex-row col-lg-4 col-md-6 col-sm-12"},wa=["onClick"],qa={class:"hot_sale2"},Sa={class:"product_img"},xa=h(()=>s("div",{class:"skeleton"},null,-1)),Ma=["src"],Ta=h(()=>s("span",null,"\u5E02\u50F9",-1)),La=h(()=>s("span",null,"\u6703\u54E1",-1)),Va=h(()=>s("span",null,"VIP",-1)),Aa=h(()=>s("span",null,"SVIP",-1)),Ba=["onClick"],Oa=h(()=>s("i",{class:"fa-solid fa-cart-shopping"},null,-1)),Ra=[Oa],Da={class:"not-found"},Fa={class:"text-center"},Na={class:"pagination post-pagination"},Ea={__name:"shop",setup(k){const C=aa(),d=sa(),E={id:-1,name:"\u6240\u6709\u7522\u54C1"},I=_(E.id),G=_(1),P=_([]),M=_(1),T=_([]),H=_([]),w=ea(),n=oa(),U=ta(),L=_(!1),J=Array.from({length:6},()=>({type:"fake"})),V=_(J);la(async()=>{await ra(),Y()});function Y(){var e;Z(),A({_categoryId:((e=d.query)==null?void 0:e.category)||-1})}async function Z(){var e,o,t;try{const l=(e=d.query)==null?void 0:e.category,a=await $fetch(`${C.public.apiBase}/${ca}`),{data:r}=a;let u=`categoryId=${l}`;(((o=d.query)==null?void 0:o.category)==="-1"||!((t=d.query)!=null&&t.category))&&(u="");const f=await $fetch(`${C.public.apiBase}/${O}?take=200&${u}`);P.value=f.data,M.value=parseInt(P.value.length/6)+1,T.value=[E,...r]}catch{}}async function A(e={_categoryId:-1,_page:1,mount:!1}){var a,r,u,f;const{_categoryId:o,_page:t,mount:l}=e;console.log(e);try{const $=o||((a=d.query)==null?void 0:a.category),b=t||((r=d.query)==null?void 0:r.page)||1,q=6;I.value=$||-1,G.value=b;let B=`categoryId=${$}`;(o==-1||!((u=d.query)!=null&&u.category)||l)&&(B=""),console.log((f=d.query)==null?void 0:f.category),console.log("b",o);const W=await $fetch(`${C.public.apiBase}/${O}?take=${q}&${B}&skip=${(b-1)*q}`),{data:z}=W;H.value=z,V.value=z;const X=await $fetch(`${C.public.apiBase}/${O}?take=200&${B}`);P.value=X.data,M.value=parseInt(P.value.length/6)+1}catch{}}function j(e){var o;return(o=n.favMerch)==null?void 0:o.find(t=>t.id===(e==null?void 0:e.id))}function K(e){n.favMerch.find(l=>l.id===(e==null?void 0:e.id))?n.favMerch=n.favMerch.filter(l=>l.id!==(e==null?void 0:e.id)):n.favMerch.push(e);const t=n.favMerch;n.updateFavMerch(t)}async function Q(e){try{const o=n.merch.find(t=>t.id===e.id);if(o){const t=(o==null?void 0:o.quantity)+1;await n.updateCartItem({type:e==null?void 0:e.attribute,cartItemId:o==null?void 0:o.cartItemId,productId:o==null?void 0:o.id,quantity:t}),U.success(`\u6B64\u5546\u54C1\u5DF2\u5B58\u5728\u8CFC\u7269\u8ECA\uFF0C\u76EE\u524D\u7E3D\u6578\uFF1A${t}`)}else await n.postCartItem({type:e==null?void 0:e.attribute,productId:e==null?void 0:e.id,quantity:1}),U.success("\u5546\u54C1\u5DF2\u52A0\u5165\u8CFC\u7269\u8ECA");await n.fetchCart()}catch(o){console.log(o)}}return(e,o)=>{var l;const t=na;return g(),v("div",ia,[s("div",_a,[s("div",pa,[s("div",ha,[s("div",fa,[s("div",va,[s("h4",ga,[s("a",{role:"button",href:"javascript:;",class:"prod-type-a",onClick:o[0]||(o[0]=a=>L.value=!c(L))}," \u7522\u54C1\u985E\u5225 ")])]),s("div",{id:"tab-collapse-area",class:p([{inactive:c(L)},"panel-collapse collapse in"]),role:"tabpanel","aria-labelledby":"headingOne"},[s("ul",null,[(g(!0),v(R,null,D(c(T),a=>{var r;return g(),v("li",{key:a.id,class:p({active:((r=c(d).query)==null?void 0:r.category)==a.id||c(I)===a.id})},[S(t,{to:`/shop?category=${a.id}`,onClick:u=>A({_categoryId:a.id,_page:1})},{default:x(()=>[y(i(a.name),1)]),_:2},1032,["to","onClick"])],2)}),128))])],2)])])]),s("div",ya,[s("ol",$a,[Ia,ba,s("li",ka,i((l=c(T).find(a=>a.id===c(I)))==null?void 0:l.name),1)]),s("div",Ca,[s("div",Pa,[(g(!0),v(R,null,D(c(V),a=>{var r,u,f,$,b;return F((g(),v("div",{key:a.id,class:"product_frame"},[s("button",{class:"add_like",onClick:q=>K(a)},[s("i",{class:p(["far fa-heart",{"fa-solid":j(a),"fa-heart":j(a)}])},null,2)],8,wa),F(s("div",qa,[s("span",null,i(a.brief),1)],512),[[N,a.brief]]),s("div",Sa,[xa,S(t,{to:`/product?id=${a.id}`},{default:x(()=>[s("img",{src:a==null?void 0:a.coverImg,alt:""},null,8,Ma)]),_:2},1032,["to"])]),s("h3",null,[S(t,{to:`/product?id=${a.id}`},{default:x(()=>[y(i(a.name),1)]),_:2},1032,["to"])]),s("ul",null,[s("li",{class:p({vip_price:!((r=c(w).user)!=null&&r.memberLevel)})},[y(" $"+i(a==null?void 0:a.price)+" ",1),Ta],2),s("li",{class:p({vip_price:((u=c(w).user)==null?void 0:u.memberLevel)==="NORMAL"})},[y(" $"+i(a==null?void 0:a.memberPrice)+" ",1),La],2),s("li",{class:p({vip_price:((f=c(w).user)==null?void 0:f.memberLevel)==="VIP"})},[y(" $"+i(a==null?void 0:a.vipPrice)+" ",1),Va],2),s("li",{class:p({vip_price:(($=c(w).user)==null?void 0:$.memberLevel)==="SVIP"})},[y(" $"+i(a==null?void 0:a.svipPrice)+" ",1),Aa],2),s("li",null,[s("button",{onClick:q=>Q(a)},Ra,8,Ba)])])])),[[N,((b=a==null?void 0:a.inventory)==null?void 0:b.quantity)>=1||(a==null?void 0:a.type)==="fake"]])}),128))])]),F(s("span",Da,"\u76EE\u524D\u6C92\u6709\u8A72\u985E\u5225\u7684\u7522\u54C1",512),[[N,!c(V).length]]),s("div",Fa,[s("ul",Na,[(g(!0),v(R,null,D(c(M),a=>(g(),v("li",{key:a,class:p({active:c(G)==a})},[S(t,{to:`/shop?category=${c(I)}&page=${a}`,onClick:r=>A({_categoryId:c(I),_page:a})},{default:x(()=>[y(i(a),1)]),_:2},1032,["to","onClick"])],2))),128))])])])])])}}},ja=m(Ea,[["__scopeId","data-v-3348c721"]]);export{ja as default};
