import{_ as g}from"./client-only.5e6823b7.js";import{b,u as v}from"./entry.8c805425.js";import{b as y,o as w,_ as $,$ as T,Z as B,a8 as e,H as u,ac as d,v as n,A as p}from"./swiper-vue.08c57f7b.js";import{u as x}from"./authStore.65c45ba4.js";import{a as m,A}from"./requestURL.059e2fdd.js";const k={class:"full_height mt185ptb30"},S={class:"container"},E=e("h3",{class:"login_tl"},[p(" \u7BA1\u7406\u8005\u767B\u5165"),e("br"),p("Login ")],-1),I={class:"contact-form"},L={id:"",method:"post",action:"javascript:;"},N={class:"form-group"},C={class:"form-group"},O={__name:"login",setup(G){const _=b(),s=x(),i=v(),a=y({email:"",password:""});w(async()=>{const t=localStorage.getItem("accessToken");if(t){try{const o=await $fetch(`${i.public.apiBase}/${m}`,{method:"GET",headers:{Authorization:"Bearer "+t}});s.loginSuccess(t),s.updateUser(o.data)}catch{s.logout()}l()}});async function f(){try{const t=await $fetch(`${i.public.apiBase}/${A}`,{method:"POST",body:a.value});h(t.data),console.log(t)}catch(t){console.log(t),t.statusCode&&alert("\u8ACB\u8F38\u5165\u6B63\u78BA\u7684\u7BA1\u7406\u5E33\u865F\u53CA\u5BC6\u78BC")}}async function h(t){const{accessToken:o}=t;s.loginSuccess(o);const c=await $fetch(`${i.public.apiBase}/${m}`,{method:"GET",headers:{Authorization:"Bearer "+o}});s.updateUser(c.data),l()}function l(){_.push("/admin")}return(t,o)=>{const c=g;return B(),$(c,null,{default:T(()=>[e("section",k,[e("div",S,[E,e("div",I,[e("form",L,[e("div",N,[u(e("input",{id:"input-field-email","onUpdate:modelValue":o[0]||(o[0]=r=>n(a).email=r),type:"email",placeholder:"Email*",class:"form-control",name:"",required:""},null,512),[[d,n(a).email]])]),e("div",C,[u(e("input",{id:"input-field-password","onUpdate:modelValue":o[1]||(o[1]=r=>n(a).password=r),autocomplete:"",type:"password",placeholder:"\u5BC6\u78BC*",class:"form-control",name:"",required:""},null,512),[[d,n(a).password]])]),e("div",{class:"text-center"},[e("input",{id:"input-field-submit",type:"submit",class:"btn btn-main btn-bag",value:"\u7BA1\u7406\u8005\u767B\u5165",onClick:f})])])])])])]),_:1})}}};export{O as default};
