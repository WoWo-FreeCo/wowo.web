import{j as I,u as L,k as O}from"./entry.c15e215c.js";import{b as k,c as g,o as A,a6 as u,a8 as e,F as M,V as R,y as s,J as p,G,C as i,ae as c,af as y,i as D,a9 as F,a0 as U,$ as j,a7 as N,Z as h}from"./swiper-vue.db7c70f4.js";import{u as q}from"./authStore.bb8876e2.js";import{u as H}from"./cartStore.9a9bfd0e.js";import{m as z}from"./requestURL.5272b7f6.js";import{P as _}from"./common.45dab837.js";const J={class:"full_height mt185ptb30"},S={id:"checkout_form",action:"javascript:;",class:"cart_container"},Y={class:"cart_list"},Z={class:"cart_img"},K=["src"],Q={class:"cart_tl"},W={class:"product-quantity"},X=e("span",null,"\u6EFF\u4EF6\u514D\u904B",-1),ee={class:"cart_price text-right"},te={class:"cart_info"},oe=e("h5",null,"\u5BC4\u9001\u65B9\u5F0F",-1),se={class:"checkout-form"},ae=e("label",{class:"radio form-check"},[e("input",{type:"radio",name:"shipping",value:"ship_home",checked:""}),i(" \u5B85\u914D\u5230\u5E9C ")],-1),ne={class:"radio form-check"},ce=e("input",{type:"radio",name:"shipping",value:"ship_market"},null,-1),re={class:"cart_info"},le=e("h5",null,"\u4ED8\u6B3E\u65B9\u5F0F",-1),ie={class:"checkout-form"},de={key:0},ue=e("label",{class:"radio form-check"},[e("input",{type:"radio",name:"payment",value:"",checked:""}),i(" \u4FE1\u7528\u5361 ")],-1),he=[ue],_e={key:1},pe=e("label",{class:"radio form-check"},[e("input",{type:"radio",name:"payment",value:"",checked:""}),i(" \u4FE1\u7528\u5361 ")],-1),me=[pe],fe={class:"cart_info"},ve={class:"checkout-form"},ye=["max"],be={id:"ship_home_form",class:"cart_info"},ke=e("h5",null,"\u6536\u4EF6\u4EBA\u8CC7\u8A0A",-1),ge={class:"ship_info"},Ce={key:0,id:"shipday",type:"datetime-local",placeholder:"\u8ACB\u9078\u64C7\u53EF\u6536\u8CA8\u65E5\u671F",class:"form-control",name:""},xe=N('<div class="cart_info checkout-form"><h5>\u767C\u7968\u8CC7\u8A0A</h5><div class="ship_info"><input id="" type="text" placeholder="\u8ACB\u8F38\u5165\u8F09\u5177\u865F\u78BC" class="form-control" name=""></div><label class="checkbox pt10 pb10"><input id="change-image" type="checkbox"> \u767C\u7968\u8981\u6253\u7D71\u7DE8 </label><div class="invoice_form d_none"><h5>\u7D71\u7DE8\u8CC7\u8A0A</h5><div class="ship_info"><input id="" type="text" placeholder="\u7D71\u4E00\u7DE8\u865F*" class="form-control" name=""><input id="" type="text" placeholder="\u767C\u7968\u62AC\u982D*" class="form-control" name=""><input id="" type="email" placeholder="\u767C\u7968\u6536\u53D6E-mail" class="form-control" name=""></div></div></div><div class="cart_info checkout-form"><h5>\u8A02\u55AE\u5099\u8A3B</h5><textarea id="" rows="6" placeholder="\u8ACB\u8F38\u5165\u5167\u5BB9" class="form-control" name=""></textarea></div>',2),Pe={class:"cart_info"},Ne=e("h5",null,"\u4ED8\u6B3E\u660E\u7D30",-1),Te={class:"cart_check"},we=e("li",null," \u904B\u8CBB\uFF1A\u514D\u904B ",-1),Ve={class:"border_top"},Ee=N('<div class="cart_info checkout-form ptb10"><label class="checkbox"><input id="check_service" type="checkbox"> \u6211\u5DF2\u7D93\u95B1\u8B80\u4E26\u540C\u610F\u4EE5\u4E0A\u8CFC\u8CB7\u9808\u77E5\u3001 <a href="/terms" target="new">\u6703\u54E1\u4F7F\u7528\u689D\u6B3E</a>\u8207<a href="/privacy" target="new">\u96B1\u79C1\u6B0A\u653F\u7B56</a>\uFF0C\u6B64\u6B04\u4F4D\u52FE\u9078\u624D\u53EF\u9001\u51FA\u3002 </label></div><div class="text-center mb-20 mt-20"><span id="errormsg"></span></div>',2),Be={class:"text-center mb-20 mt-20"},Ge={__name:"checkout",setup($e){const T=I(),w=L(),n=q(),d=H(),r=k(0),l=k(_.General),b=g({get:()=>f.value.reduce((t,a)=>t+C(a)*a.amount,0),set:t=>{b.value=t}}),m=g(()=>{var t;return((t=n==null?void 0:n.user)==null?void 0:t.rewardCredit)||0}),f=g(()=>{switch(l.value){case _.ColdChain:return d==null?void 0:d.merch.filter(t=>t.attribute==="COLD_CHAIN");default:return d==null?void 0:d.merch.filter(t=>t.attribute==="GENERAL")}});A(()=>{V()});function V(){switch(T.query.type){case"cold-chain":l.value=_.ColdChain;break;default:l.value=_.General;break}}const C=t=>{var a,v;return((a=n==null?void 0:n.user)==null?void 0:a.memberLevel)==="SVIP"?t==null?void 0:t.svipPrice:((v=n==null?void 0:n.user)==null?void 0:v.memberLevel)==="VIP"?t==null?void 0:t.vipPrice:n.status.loggedIn?t==null?void 0:t.memberPrice:t==null?void 0:t.price},E=k({attribute:l,consignee:{deliveryType:"HOME",addressDetailOne:"\u6C11\u751F\u4E1C\u8DEF\u4E09\u6BB5156\u53F7",city:"\u53F0\u5317\u5E02",district:"\u4E2D\u6B63\u5340",email:"yummy.123@gmail.com",idNo:"F123456789",idType:"1",cellphone:"0912345678",name:"\u5F35\u5927\u90CE",province:"\u53F0\u7063",remark:"\u5047\u6587\uFF08\u6536\u4EF6\u5907\u6CE8\uFF09",stationCode:"999854",stationName:"\u91D1\u5168",town:"\u4EC1\u611B\u91CC",zipCode:"100001",senderRemark:"\u5047\u6587\uFF08\u5BC4\u4EF6\u5907\u6CE8\uFF09"},invoiceParams:{customerName:"\u738B\u5C0F\u660E",customerEmail:"abc@gmail.com",customerPhone:"0987654321",customerAddr:"\u53F0\u5317\u5E02\u5EF6\u5E73\u5357\u8DEF85\u865F4\u6A13",customerIdentifier:"00000000",carruerType:"",carruerNum:"",donation:"0",loveCode:""},products:f.value.map(t=>({id:t.id,quantity:t.amount}))});async function B(){try{const t=await $fetch(`${w.public.apiBase}/${z}`,{method:"POST",body:E.value,headers:{authorization:"Bearer "+localStorage.getItem("accessToken")}}),a=document.createElement("credit-div");a.innerHTML=t,a.id="credit-payment",document.body.appendChild(a),document.getElementById("_form_aiochk").submit(),console.log(t)}catch(t){console.log(t)}}function $(){r.value=r.value>m.value?m.value:r.value}return(t,a)=>{const v=O;return h(),u("div",J,[e("form",S,[e("table",Y,[e("tbody",null,[(h(!0),u(M,null,R(s(f),o=>{var x,P;return h(),u("tr",{key:o.id},[e("td",Z,[e("img",{src:((x=o==null?void 0:o.thumbnail)==null?void 0:x.url)||"/products/p"+(o.id-10)+".jpg"},null,8,K)]),e("td",Q,[e("h5",null,c(o==null?void 0:o.name),1),e("div",W," x"+c(o==null?void 0:o.amount),1),X]),e("td",ee,[e("span",null,"\u5E02\u50F9 $"+c((P=o==null?void 0:o.price)==null?void 0:P.market),1),i(" \u50F9\u9322 $"+c(C(o)),1)])])}),128))])]),e("div",te,[oe,e("div",se,[ae,p(e("label",ne,[ce,i(" \u8D85\u5546\u53D6\u8CA8 ")],512),[[G,s(l)===s(_).ColdChain]])])]),e("div",re,[le,e("div",ie,[s(l)===s(_).General?(h(),u("div",de,he)):(h(),u("div",_e,me))])]),e("div",fe,[e("h5",null,"\u7D05\u5229\u6263\u9EDE (\u76EE\u524D\u53EF\u7528\u7D05\u5229\uFF1A"+c(s(m))+" \u9EDE)",1),e("div",ve,[p(e("input",{id:"","onUpdate:modelValue":a[0]||(a[0]=o=>D(r)?r.value=o:null),type:"number",min:"0",max:s(m),placeholder:"\u8ACB\u8F38\u5165\u672C\u6B21\u9810\u4F7F\u7528\u7D05\u5229",class:"form-control",name:"",onChange:$},null,40,ye),[[y,s(r)]])])]),e("div",be,[ke,e("div",ge,[p(e("input",{id:"ship_name2","onUpdate:modelValue":a[1]||(a[1]=o=>s(n).user.nickname=o),type:"text",placeholder:"\u59D3\u540D*",class:"form-control",name:""},null,512),[[y,s(n).user.nickname]]),p(e("input",{id:"ship_phone2","onUpdate:modelValue":a[2]||(a[2]=o=>s(n).user.cellphone=o),type:"text",placeholder:"\u624B\u6A5F*",class:"form-control",name:""},null,512),[[y,s(n).user.cellphone]]),p(e("input",{id:"ship_address","onUpdate:modelValue":a[3]||(a[3]=o=>s(n).user.addressOne=o),type:"text",placeholder:"\u5730\u5740*",class:"form-control",name:""},null,512),[[y,s(n).user.addressOne]]),s(l)==="normal"?(h(),u("input",Ce)):F("",!0)])]),xe,e("div",Pe,[Ne,e("ul",Te,[e("li",null," \u5546\u54C1\u91D1\u984D\u5C0F\u8A08 (\u5171"+c(s(f).length)+"\u9805\u5546\u54C1)\uFF1A$"+c(s(b)),1),we,e("li",null," \u7D05\u5229\u6263\u9EDE\uFF1A"+c(s(r)),1),e("li",Ve,[i(" \u8A02\u55AE\u7E3D\u91D1\u984D\uFF1A"),e("span",null,"$"+c(s(b)-s(r)),1)])])]),Ee,e("div",Be,[U(v,{type:"button",class:"btn btn-main btn-default",to:"/cart"},{default:j(()=>[i(" \u4E0A\u4E00\u9801 ")]),_:1}),e("input",{id:"",type:"submit",class:"btn btn-main btn-check check_service_btn submit_home",value:"\u78BA\u8A8D\u9001\u51FA",onClick:B})])])])}}};export{Ge as default};
