import{E as x,q as $,b as k,u as B,z as f,K as q,B as E}from"./entry.c9000b64.js";import{_ as S}from"./client-only.73480984.js";import{b as C,o as L,a3 as R,a0 as d,Z as N,aa as t,J as h,af as g,y as r,$ as b,C as c}from"./swiper-vue.d582d122.js";import{u as U}from"./authStore.1f47292a.js";const V={class:"full_height mt185ptb30"},G={class:"container"},P=t("h3",{class:"login_tl"},[c(" \u6703\u54E1\u767B\u5165"),t("br"),c("Login ")],-1),z={class:"contact-form"},A={id:"",method:"post",action:"javascript:;"},I={class:"form-group"},M={class:"form-group"},O={class:"text-center mt-30"},F=t("i",{class:"fa-regular fa-circle-question"},null,-1),j={class:"other_function"},Q={__name:"login",setup(D){const p=x(),_=$(),i=k(),a=U(),l=B(),n=C({email:"",password:""});L(async()=>{const e=localStorage.getItem("accessToken");if(e){try{const s=await $fetch(`${l.public.apiBase}/${f}`,{method:"GET",headers:{Authorization:"Bearer "+e}});a.loginSuccess(e),a.updateUser(s.data),i.success("\u5DF2\u81EA\u52D5\u767B\u5165")}catch{a.logout(),i.error("\u767B\u5165\u5DF2\u903E\u671F\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165")}m()}});async function y(){try{const e=await $fetch(`${l.public.apiBase}/${q}`,{method:"POST",body:n.value});v(e.data),i.success("\u767B\u5165\u6210\u529F")}catch(e){e.statusCode&&i.error("\u8ACB\u8F38\u5165\u6B63\u78BA\u7684\u5E33\u865F\u53CA\u5BC6\u78BC")}}async function v(e){const{accessToken:s}=e;a.loginSuccess(s);const o=await $fetch(`${l.public.apiBase}/${f}`,{method:"GET",headers:{Authorization:"Bearer "+s}});a.updateUser(o.data),m()}function m(){var s;const e=(s=p.query)==null?void 0:s.redirect;if(e){const o={...p.query};delete o.redirect,_.push({path:e,query:o})}else _.push({path:"/profile"})}function w(){window.scrollTo({top:0,behavior:"smooth"})}return(e,s)=>{const o=E,T=S;return N(),R(T,null,{default:d(()=>[t("section",V,[t("div",G,[P,t("div",z,[t("form",A,[t("div",I,[h(t("input",{id:"input-field-email","onUpdate:modelValue":s[0]||(s[0]=u=>r(n).email=u),type:"email",placeholder:"Email*",class:"form-control",name:"",required:""},null,512),[[g,r(n).email]])]),t("div",M,[h(t("input",{id:"input-field-password","onUpdate:modelValue":s[1]||(s[1]=u=>r(n).password=u),autocomplete:"",type:"password",placeholder:"\u5BC6\u78BC*",class:"form-control",name:"",required:""},null,512),[[g,r(n).password]])]),t("div",{class:"text-center"},[t("input",{id:"input-field-submit",type:"submit",class:"btn btn-main btn-bag",value:"\u6211\u8981\u767B\u5165",onClick:y})])]),t("div",O,[F,b(o,{to:"/forget"},{default:d(()=>[c(" \u5FD8\u8A18\u5BC6\u78BC? ")]),_:1})]),t("div",j,[c(" \u6C92\u6709\u5E33\u865F? "),t("div",{onClick:w},[b(o,{class:"btn btn-block btn-bag",to:"/register"},{default:d(()=>[c(" \u6703\u54E1\u8A3B\u518A ")]),_:1})])])])])])]),_:1})}}};export{Q as default};
