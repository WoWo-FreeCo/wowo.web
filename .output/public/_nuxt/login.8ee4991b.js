import{E as k,q as w,b as $,u as x,z as h,K as B,B as S}from"./entry.b2c13a7d.js";import{_ as E}from"./client-only.46688fa6.js";import{b as q,o as C,a3 as L,a0 as f,Z as R,aa as e,J as g,af as b,y as c,C as i,$ as N}from"./swiper-vue.6d0a2b42.js";import{u as U}from"./authStore.8141f46b.js";const V={class:"full_height mt185ptb30"},G={class:"container"},I=e("h3",{class:"login_tl"},[i(" \u6703\u54E1\u767B\u5165"),e("br"),i("Login ")],-1),P={class:"contact-form"},z={id:"",method:"post",action:"javascript:;"},A={class:"form-group"},M={class:"form-group"},O={class:"other_function"},Z={__name:"login",setup(F){const p=k(),m=w(),r=$(),a=U(),l=x(),n=q({email:"",password:""});C(async()=>{const t=localStorage.getItem("accessToken"),o=localStorage.getItem("refreshToken");if(t){try{const s=await $fetch(`${l.public.apiBase}/${h}`,{method:"GET",headers:{Authorization:"Bearer "+t}});a.loginSuccess(t,o),a.updateUser(s.data),r.success("\u5DF2\u81EA\u52D5\u767B\u5165")}catch{a.logout(),r.error("\u767B\u5165\u5DF2\u903E\u671F\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165");return}_()}});async function y(){try{const t=await $fetch(`${l.public.apiBase}/${B}`,{method:"POST",body:n.value});T(t.data),r.success("\u767B\u5165\u6210\u529F")}catch(t){t.statusCode&&r.error("\u8ACB\u8F38\u5165\u6B63\u78BA\u7684\u5E33\u865F\u53CA\u5BC6\u78BC")}}async function T(t){const{accessToken:o,refreshToken:s}=t;a.loginSuccess(o,s);const u=await $fetch(`${l.public.apiBase}/${h}`,{method:"GET",headers:{Authorization:"Bearer "+o}});a.updateUser(u.data),_()}function _(){var o;const t=(o=p.query)==null?void 0:o.redirect;if(t){const s={...p.query};delete s.redirect,m.push({path:t,query:s})}else m.push({path:"/profile"})}function v(){window.scrollTo({top:0,behavior:"smooth"})}return(t,o)=>{const s=S,u=E;return R(),L(u,null,{default:f(()=>[e("section",V,[e("div",G,[I,e("div",P,[e("form",z,[e("div",A,[g(e("input",{id:"input-field-email","onUpdate:modelValue":o[0]||(o[0]=d=>c(n).email=d),type:"email",placeholder:"Email*",class:"form-control",name:"",required:""},null,512),[[b,c(n).email]])]),e("div",M,[g(e("input",{id:"input-field-password","onUpdate:modelValue":o[1]||(o[1]=d=>c(n).password=d),autocomplete:"",type:"password",placeholder:"\u5BC6\u78BC*",class:"form-control",name:"",required:""},null,512),[[b,c(n).password]])]),e("div",{class:"text-center"},[e("input",{id:"input-field-submit",type:"submit",class:"btn btn-main btn-bag",value:"\u6211\u8981\u767B\u5165",onClick:y})])]),e("div",O,[i(" \u6C92\u6709\u5E33\u865F? "),e("div",{onClick:v},[N(s,{class:"btn btn-block btn-bag",to:"/register"},{default:f(()=>[i(" \u6703\u54E1\u8A3B\u518A ")]),_:1})])])])])])]),_:1})}}};export{Z as default};
